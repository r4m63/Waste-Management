@startuml
title UC1: Приём рейса и размещение партий
skinparam defaultFontName "DejaVu Sans"
autonumber

actor "Приёмщик" as R
actor "Кладовщик" as W
participant "ИС" as IS
participant "Весы" as S

== Регистрация прибытия ==
R -> IS: Скан ID рейса / check-in
IS --> R: OK / деталь рейса
alt Документ неверный/просрочен
  IS --> R: Ошибка + причина
  R -> IS: Выбор рейса вручную
  IS --> R: OK
end
IS -> IS: Проверка прав/статуса рейса

== Взвешивание и приём ==
R -> S: Взвесить брутто
S --> R: mass_gross
R -> IS: POST /intake/measurements {gross}
alt Нестабильные показания
  R -> S: Повторное взвешивание
  S --> R: mass_gross'
  R -> IS: update gross
end
R -> R: Разгрузка
R -> S: Взвесить тару
S --> R: mass_tare
alt Нет данных по таре
  R -> IS: Ввод тары вручную
end
R -> IS: Рассчитать нетто = gross - tare
IS -> IS: Верификация/сверка ТТН
alt Несоответствие данным
  IS --> R: Сообщение + запрос исправления
  R -> IS: Корректирующие данные
end
IS -> IS: Создать партии приёмки
IS --> R: partyIds

== Размещение во входной зоне ==
R -> IS: Подбор зоны/ячейки по параметрам
IS --> R: slotId / рекомендации
alt Нет свободных мест
  IS --> R: Предложить буферную зону
end
R -> IS: Печать ярлыка партии
IS --> R: label (ID)
W -> IS: Фиксация размещения (ячейка, время)
IS --> W: Карта склада обновлена
@enduml
