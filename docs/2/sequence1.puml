@startuml
title Sequence — UC-A: Планирование и назначение
skinparam defaultFontName "DejaVu Sans"
autonumber

participant "ИС/Планировщик" as IS
participant "Инвентарь тары" as INV
participant "Телематика (история)" as TEL
participant "Маршрутизация/карты" as MAP
participant "Приложение водителя" as APP

IS -> IS: собрать статусы точек\n(заполненность/доступность)
IS -> INV: GET /containers/availability
INV --> IS: остатки по размерам
IS -> TEL: GET /traffic/history?window=D-7
TEL --> IS: паттерны/ограничения

IS -> MAP: POST /route-matrix {points, constraints}
MAP --> IS: time/distance matrix

IS -> IS: построить маршруты\n(окна, ограничения ТС, объёмы)
IS -> INV: reserve(containers, routes)
INV --> IS: OK/корректировки

IS -> APP: POST /routes/publish {driverId, vehicleId, route}
APP --> IS: 202 Accepted
@enduml
