@startuml
title Монолит — обзор модулей (упрощённо, без Outbox и Catalogs)
skinparam componentStyle rectangle
skinparam defaultFontName "DejaVu Sans"

actor "Житель" as Resident
actor "Водитель" as Driver
actor "Диспетчер" as Dispatcher

package "Монолитный сервис (Jakarta)" {
  [API-шлюз] <<REST>>
  [Приём (Intake)] <<модуль>>
  [Планирование (Routing)] <<модуль>>
  [Исполнение рейса (Execution)] <<модуль>>
  [Корректировка маршрута (Adjustment)] <<модуль>>
  [Пользователи/Роли (Identity)] <<OIDC-клиент>>
  [Отчётность (Reporting)] <<модуль>>
  database "PostgreSQL" as PG
}

Resident --> [API-шлюз]
Driver   --> [API-шлюз]
Dispatcher --> [API-шлюз]

[API-шлюз] --> [Приём (Intake)]
[API-шлюз] --> [Планирование (Routing)]
[API-шлюз] --> [Исполнение рейса (Execution)]
[API-шлюз] --> [Корректировка маршрута (Adjustment)]

[Приём (Intake)] --> PG
[Планирование (Routing)] --> PG
[Исполнение рейса (Execution)] --> PG
[Корректировка маршрута (Adjustment)] --> PG
[Отчётность (Reporting)] --> PG
[Пользователи/Роли (Identity)] --> PG
@enduml
