@startuml
skinparam nodeStyle rectangle

node "User Browser" as browser {
  component "Landing UI"
}

node "Kiosk Host" as kiosk {
  component "Kiosk UI"
}

node "Backend Host/Cluster" as back {
  node "Edge" {
    component "Nginx / API Gateway"
  }
  node "Services" {
    component "svc-kiosk"
    component "svc-pricing"
    component "svc-intake"
    component "svc-notify"
  }
  node "Data" {
    database "Postgres\n(3 схемы)" as pg
    component "Redis"
    component "Kafka/Redpanda"
  }
}

browser --> "Nginx / API Gateway" : HTTPS
kiosk --> "Nginx / API Gateway" : HTTPS
"Nginx / API Gateway" --> "svc-kiosk"
"Nginx / API Gateway" --> "svc-pricing"
"svc-kiosk" --> "svc-pricing" : HTTP (quote)
"svc-kiosk" --> "Kafka/Redpanda" : intake.requested
"svc-intake" --> "Kafka/Redpanda" : intake.recorded\nreceipt.issued
"svc-notify" --> "Kafka/Redpanda" : consume
"svc-kiosk" --> "Kafka/Redpanda" : consume receipt.issued
"svc-kiosk" --> pg
"svc-pricing" --> pg
"svc-intake" --> pg
"svc-kiosk" --> Redis : cache
@enduml
